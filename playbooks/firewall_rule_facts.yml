- name: Facts about policies
  hosts: localhost
  gather_facts: no
  tasks:
  - name: Show rules for policy 'asimpleanypolicy' (only shows name, type)
    firewall_rule_facts:
      filter: asimpleanypolicy

  - name: Search for specific rule/s using search value (partial searching supported)
    firewall_rule_facts:
      filter: asimpleanypolicy
      search: anyrule

  - name: Dump the results in yaml format, showing details of rule
    firewall_rule_facts:
      filter: asimpleanypolicy
      exact_match: false
      search: anyrule
      as_yaml: true

  - name: Resolve the source, destination and services fields
    firewall_rule_facts:
      filter: asimpleanypolicy
      search: rulet
      as_yaml: true
      expand:
      - sources
      - destinations
      - services

  - name: Get specific rules based on range order (rules 1-10)
    firewall_rule_facts:
      filter: asimpleanypolicy
      rule_range: 1-3
      as_yaml: true
  
  - name: Get firewall rule as yaml
    register: results
    firewall_rule_facts:
      smc_logging:
       level: 10
       path: ansible-smc.log
      filter: asimpleanypolicy
      #search: rulet
      exact_match: true
      as_yaml: true
      expand:
      - services
      - destinations
      - sources
  
  - name: Write the yaml using a jinja template
    template: src=templates/facts_yaml.j2 dest=./firewall_rule_jinja.yml
    vars:
      playbook: firewall_rule
